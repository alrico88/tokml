var l=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var h=Object.prototype.hasOwnProperty;var A=(e,r)=>{for(var t in r)l(e,t,{get:r[t],enumerable:!0})},b=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of x(r))!h.call(e,a)&&a!==t&&l(e,a,{get:()=>r[a],enumerable:!(i=j(r,a))||i.enumerable});return e};var D=e=>b(l({},"__esModule",{value:!0}),e);var J={};A(J,{toKML:()=>q});module.exports=D(J);function c(e,r){let t={">":"&gt;","<":"&lt;","'":"&apos;",'"':"&quot;","&":"&amp;"};var i;if(e!=null)return r=(r||"").replace(/[^&"<>\']/g,""),i=`([&"<>'])`.replace(new RegExp("["+r+"]","g"),""),e.replace(new RegExp(i,"g"),function(a,o){return t[o]})}function O(e){return Object.keys(e).length?" "+Object.keys(e).map(function(r){return r+'="'+c(e[r])+'"'}).join(" "):""}function n(e,r,t){return(Array.isArray(r)||typeof r=="string")&&(t=r,r={}),Array.isArray(t)&&(t=`
`+t.map(function(i){return"  "+i}).join(`
`)+`
`),"<"+e+O(r)+">"+t+"</"+e+">"}function m(e){return e.map(function(r){return r.join(",")}).join(" ")}var u={Point:function(e){return n("Point",n("coordinates",e.coordinates.join(",")))},LineString:function(e){return n("LineString",n("coordinates",m(e.coordinates)))},Polygon:function(e){if(!e.coordinates.length)return"";var r=e.coordinates[0],t=e.coordinates.slice(1),i=n("outerBoundaryIs",n("LinearRing",n("coordinates",m(r)))),a=t.map(function(o){return n("innerBoundaryIs",n("LinearRing",n("coordinates",m(o))))}).join("");return n("Polygon",i+a)},MultiPoint:function(e){return e.coordinates.length?n("MultiGeometry",e.coordinates.map(function(r){return u.Point({coordinates:r})}).join("")):""},MultiPolygon:function(e){return e.coordinates.length?n("MultiGeometry",e.coordinates.map(function(r){return u.Polygon({coordinates:r})}).join("")):""},MultiLineString:function(e){return e.coordinates.length?n("MultiGeometry",e.coordinates.map(function(r){return u.LineString({coordinates:r})}).join("")):""},GeometryCollection:function(e){return n("MultiGeometry",e.geometries.map(u.any).join(""))},valid:function(e){return e&&e.type&&(e.coordinates||e.type==="GeometryCollection"&&e.geometries&&e.geometries.every(u.valid))},any:function(e){return u[e.type]?u[e.type](e):""},isPoint:function(e){return e.type==="Point"||e.type==="MultiPoint"},isPolygon:function(e){return e.type==="Polygon"||e.type==="MultiPolygon"},isLine:function(e){return e.type==="LineString"||e.type==="MultiLineString"}};function d(e,r){if(typeof e!="string")return"";if(e=e.replace("#","").toLowerCase(),e.length===3)e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2];else if(e.length!==6)return"";var t=e[0]+e[1],i=e[2]+e[3],a=e[4]+e[5],o="ff";return typeof r=="number"&&r>=0&&r<=1&&(o=(r*255).toString(16),o.indexOf(".")>-1&&(o=o.substr(0,o.indexOf("."))),o.length<2&&(o="0"+o)),o+a+i+t}function y(e){return!!(e["marker-size"]||e["marker-symbol"]||e["marker-color"])}function g(e){delete e["marker-size"],delete e["marker-symbol"],delete e["marker-color"],delete e["marker-shape"]}var z=n("hotSpot",{xunits:"fraction",yunits:"fraction",x:"0.5",y:"0.5"},"");function R(e,r){var t=r["marker-size"]||"medium",i=r["marker-symbol"]?"-"+r["marker-symbol"]:"",a=(r["marker-color"]||"7e7e7e").replace("#","");return e+"pin-"+t.charAt(0)+i+"+"+a+".png"}function k(e,r,t){return n("Style",{id:t},n("IconStyle",n("Icon",n("href",R(e,r))))+z)}function S(e){for(var r in e)if({stroke:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,"fill-opacity":!0}[r])return!0}function v(e){delete e.stroke,delete e["stroke-opacity"],delete e["stroke-width"],delete e.fill,delete e["fill-opacity"]}function P(e,r){var t=n("LineStyle",n("color",d(e.stroke,e["stroke-opacity"])||"ff555555")+n("width",{},e["stroke-width"]===void 0?2:e["stroke-width"])),i="";return(e.fill||e["fill-opacity"])&&(i=n("PolyStyle",n("color",{},d(e.fill,e["fill-opacity"])||"88555555"))),n("Style",{id:r},t+i)}function L(e){var r="";return e["marker-symbol"]&&(r=r+"ms"+e["marker-symbol"]),e["marker-color"]&&(r=r+"mc"+e["marker-color"].replace("#","")),e["marker-size"]&&(r=r+"ms"+e["marker-size"]),e.stroke&&(r=r+"s"+e.stroke.replace("#","")),e["stroke-width"]&&(r=r+"sw"+e["stroke-width"].toString().replace(".","")),e["stroke-opacity"]&&(r=r+"mo"+e["stroke-opacity"].toString().replace(".","")),e.fill&&(r=r+"f"+e.fill.replace("#","")),e["fill-opacity"]&&(r=r+"fo"+e["fill-opacity"].toString().replace(".","")),r}function w(e){var r=[];for(var t in e)e[t]?r.push([t,e[t]]):r.push([t,""]);return r}var M=require("defu");function G(e){return e.documentName!==void 0?n("name",e.documentName):""}function U(e){return e.documentDescription!==void 0?n("description",e.documentDescription):""}function N(e,r){return e[r.name]?n("name",c(e[r.name])):""}function B(e,r){return e[r.description]?n("description",c(e[r.description])):""}function F(e,r){return e[r.timestamp]?n("TimeStamp",n("when",c(e[r.timestamp]))):""}function I(e){return n("Data",{name:e[0]},n("value",{},c(e[1]?typeof e[1]=="string"?e[1]:JSON.stringify(e[1]):"")))}function E(e){return n("ExtendedData",{},w(e).map(I).join(""))}function p(e,r){return function(t){if(!t.properties||!u.valid(t.geometry))return"";var i=u.any(t.geometry);if(!i)return"";var a="",o="";if(e.simplestyle){var f=L(t.properties);f&&(u.isPoint(t.geometry)&&y(t.properties)?(r.indexOf(f)===-1&&(a=k(e.iconBaseUrl,t.properties,f),r.push(f)),o=n("styleUrl","#"+f),g(t.properties)):(u.isPolygon(t.geometry)||u.isLine(t.geometry))&&S(t.properties)&&(r.indexOf(f)===-1&&(a=P(t.properties,f),r.push(f)),o=n("styleUrl","#"+f),v(t.properties)))}var s={};return t.id&&(s.id=t.id.toString()),a+n("Placemark",s,N(t.properties,e)+B(t.properties,e)+E(t.properties)+F(t.properties,e)+i+o)}}function T(e,r){if(!e.type)return"";var t=[];switch(e.type){case"FeatureCollection":return e.features?e.features.map(p(r,t)).join(""):"";case"Feature":return p(r,t)(e);default:return p(r,t)({type:"Feature",geometry:e,properties:{}})}}var K={documentName:void 0,documentDescription:void 0,name:"name",description:"description",simplestyle:!1,iconBaseUrl:"https://api.tiles.mapbox.com/v3/marker/",timestamp:"timestamp"};function q(e,r){return r=(0,M.defu)(r,K),'<?xml version="1.0" encoding="UTF-8"?>'+n("kml",{xmlns:"http://www.opengis.net/kml/2.2"},n("Document",G(r)+U(r)+T(e,r)))}0&&(module.exports={toKML});
//# sourceMappingURL=index.js.map